var M=Object.defineProperty,v=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var _=(s,a,o)=>a in s?M(s,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[a]=o,C=(s,a)=>{for(var o in a||(a={}))O.call(a,o)&&_(s,o,a[o]);if(T)for(var o of T(a))$.call(a,o)&&_(s,o,a[o]);return s},P=(s,a)=>v(s,E(a));var m=(s,a,o)=>new Promise((p,h)=>{var i=r=>{try{l(o.next(r))}catch(u){h(u)}},d=r=>{try{l(o.throw(r))}catch(u){h(u)}},l=r=>r.done?p(r.value):Promise.resolve(r.value).then(i,d);l((o=o.apply(s,a)).next())});import{a as j,b as S,j as t,R as A}from"./index-DC7UpFGv.js";import{u as F}from"./useAuthRedirect-ByGetqE6.js";import{r as c,u as B}from"./react-BIszHAjf.js";import{a as w}from"./fetchHelper-0U2Sk_BC.js";import{h as D,_ as L,W as Y,X as W,d as f,$ as G,Z as K,j as X,k as b}from"./antd-BQr4HBC_.js";import{R as N}from"./index-DKgI-zXx.js";import"./install-Dn5CJfUk.js";const U=s=>m(void 0,null,function*(){return yield w(`miningPool/listBtcMiningPoolRealTimeHashRate/${s}`)}),Z=s=>m(void 0,null,function*(){return yield w(`miningPool/listAllHashCompletionRate/${s}`)}),q=(s,a,o)=>m(void 0,null,function*(){return yield w(`miningPool/getHashRateHistory/${s}/${a}/${o}`)});function J(){const{poolType:s}=j(S(["poolType"])),[a,o]=c.useState(null),[p,h]=c.useState(!0),[i,d]=c.useState(1),[l,r]=c.useState(10),u=e=>m(this,null,function*(){try{const g=(yield Z(e)).data.sort((R,H)=>new Date(H.date).getTime()-new Date(R.date).getTime());o(g)}catch(n){}finally{h(!1)}});c.useEffect(()=>{u(s)},[s]);const y=[{title:"日期",dataIndex:"date",key:"date",sorter:(e,n)=>new Date(n.date).getTime()-new Date(e.date).getTime()},{title:"算力达成率",dataIndex:"hash_completion_rate",key:"hash_completion_rate",render:e=>t.jsxs("span",{children:[e.toFixed(2),"%"]})}],x=a==null?void 0:a.slice((i-1)*l,i*l);return t.jsxs(D,{title:t.jsxs("span",{children:[t.jsx(L,{style:{marginRight:8}})," ","历史达成率"]}),loading:p,bordered:!1,children:[t.jsx(Y,{dataSource:x,columns:y,rowKey:"date",pagination:!1,showHeader:!1}),t.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:t.jsx(W,{current:i,pageSize:l,total:a==null?void 0:a.length,onChange:(e,n)=>{d(e),r(n)},showSizeChanger:!0,pageSizeOptions:[10,20,50]})})]})}const{RangePicker:Q}=K;function V(){const{poolType:s}=j(S(["poolType"])),[a,o]=c.useState(null),[p,h]=c.useState(!0),[i,d]=c.useState((()=>{const e=f().subtract(1,"day").startOf("day"),n=f().startOf("day");return[e,n]})()),l=B(),r=e=>{l(A.poolHashHistory(e))},u=e=>m(this,null,function*(){var n;try{o(null);const g=i[0]?i[0].format("YYYY-MM-DD"):f().subtract(1,"day").format("YYYY-MM-DD"),R=i[1]?i[1].format("YYYY-MM-DD"):f().format("YYYY-MM-DD"),z=(n=(yield q(e,g,R)).data)==null?void 0:n.sort((k,I)=>new Date(I.date).getTime()-new Date(k.date).getTime());o(z)}catch(g){}finally{h(!1)}});c.useEffect(()=>{u(s)},[s,i]);const y=[{title:"矿池名称",dataIndex:"pool_name",key:"pool_name",width:150,ellipsis:!0,render:(e,n)=>t.jsx("a",{onClick:()=>r(n.pool_name),title:n.pool_name,style:{color:"#6bacf8",cursor:"pointer"},children:e})},{title:"算力",dataIndex:"hash_rate",key:"hash_rate",render:e=>t.jsxs("span",{children:[e," ",t.jsx("span",{style:{fontSize:"12px"},children:"PH/s"})]})},{title:"理论算力",dataIndex:"settlement_theoretical_hash",key:"settlement_theoretical_hash",render:e=>t.jsxs("span",{children:[e," ",t.jsx("span",{style:{fontSize:"12px"},children:"PH/s"})]})},{title:"算力达成率",dataIndex:"hash_completion_rate",key:"hash_completion_rate",render:e=>t.jsxs("span",{children:[parseFloat(e).toFixed(2),"%"]}),sorter:(e,n)=>parseFloat(e.hash_completion_rate)-parseFloat(n.hash_completion_rate)},{title:"日期",dataIndex:"date",key:"date",sorter:(e,n)=>new Date(n.date).getTime()-new Date(e.date).getTime()}],x=e=>{if(e&&e[0]&&e[1]){const n=e[0],g=e[1];d([n,g])}else d([null,null]),o(null)};return t.jsx(D,{title:t.jsxs("span",{children:[t.jsx(G,{style:{marginRight:8}})," ","历史算力"]}),bordered:!1,extra:t.jsx(Q,{value:i,onChange:x,style:{width:"280px",fontSize:"12px"}}),loading:p,style:{width:"100%",height:"100%"},children:t.jsx(Y,{dataSource:a,columns:y,rowKey:"date",pagination:{position:["bottomCenter"],showSizeChanger:!0,pageSizeOptions:["10","20","50"],defaultPageSize:10},components:{header:{cell:e=>t.jsx("th",P(C({},e),{style:{color:"#888",fontSize:"12px",lineHeight:"10px",height:"10px"}}))}},scroll:{x:"max-content"}})})}function ee(){const{poolType:s}=j(S(["poolType"])),[a,o]=c.useState(null),[p,h]=c.useState(!0),i=l=>m(this,null,function*(){try{const r=yield U(l);o(r.data)}catch(r){}finally{h(!1)}});c.useEffect(()=>{i(s)},[s]);const d=()=>({title:{text:"实时总算力详情",left:"left",top:"0",textStyle:{fontWeight:"bold",fontSize:"16px",color:"#333"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} PH/s ({d}%)",textStyle:{fontSize:14}},legend:{orient:"vertical",right:"10",itemWidth:8,itemHeight:8,top:"top",textStyle:{fontSize:12,color:"#99A1B7"},type:"scroll",padding:10,itemGap:10},series:[{name:"实时算力",type:"pie",radius:["60%","90%"],label:{show:!0,color:"#99A1B7",fontSize:12},data:a?a.map(({pool_name:l,current_hash_rate:r})=>({value:r,name:l})):[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});return t.jsx(D,{bordered:!1,style:{width:"100%"},loading:p,children:t.jsx("div",{children:t.jsx(N,{option:d(),style:{height:400}})})})}function ce(){return F(),t.jsxs("div",{children:[t.jsx(ee,{}),t.jsxs(X,{gutter:24,style:{marginTop:"20px"},children:[t.jsx(b,{span:14,children:t.jsx(V,{})}),t.jsx(b,{span:10,children:t.jsx(J,{})})]})]})}export{ce as default};
