var w=(d,t,o)=>new Promise((m,g)=>{var u=l=>{try{x(o.next(l))}catch(h){g(h)}},p=l=>{try{x(o.throw(l))}catch(h){g(h)}},x=l=>l.done?m(l.value):Promise.resolve(l.value).then(u,p);x((o=o.apply(d,t)).next())});import{j as e}from"./index-CTW2SOmh.js";import{m as S,r as f}from"./react-BIszHAjf.js";import"./index-BlJ-5gRZ.js";import{g as $}from"./api-H8rjveU7.js";import{bo as D,bp as F,bi as v,$ as M,bq as E,br as C,bs as A,bt as R,bu as I,bv as G,bw as L,y as j,B as N,W as k}from"./antd-DyiLpPLO.js";import{d as T,L as z}from"./install-DJKZGxT7.js";import"./install-DLPvrVJV.js";import"./fetchHelper-C0alrpJ8.js";const B=()=>{var y;const{venueId:d}=S(),[t,o]=f.useState(null),[m,g]=f.useState(""),p=new Date(Date.now()-864e5).toISOString().split("T")[0],x=()=>w(void 0,null,function*(){try{const a=yield $(Number(d),p);o(a.data);const{failureRate24h:r,impactRatio:i,limitImpactRate:s,highTemperatureRate:n}=a.data,b=i-r-s-n;g(b.toFixed(2))}catch(a){console.log(a)}});f.useEffect(()=>{x()},[d]);const l=[{title:"理论台数",value:(t==null?void 0:t.totalMachines)+" 台",description:"满负荷运行中",icon:e.jsx(D,{className:"text-gray-400"})},{title:"故障总台数",value:(t==null?void 0:t.totalFailures)+" 台",description:"需要检修",textColor:"text-yellow-500",icon:e.jsx(F,{className:"text-gray-400 font-12"})},{title:"理论算力",value:((y=t==null?void 0:t.theoreticalPower)==null?void 0:y.toFixed(2))+" PH/s",description:"标准水平",icon:e.jsx(v,{className:"text-gray-400 font-12"})},{title:"24 小时算力",value:(t==null?void 0:t.power24h)+" PH/s",textColor:"text-yellow-500",icon:e.jsx(M,{className:"text-gray-400 font-12"})}],h=[{title:"故障占比",value:(t==null?void 0:t.failureRate24h.toFixed(2))+" %",description:"一般水平",icon:e.jsx(E,{className:"text-gray-400 font-12"})},{title:"高温占比",value:(t==null?void 0:t.highTemperatureRate.toFixed(2))+" %",description:"正常范围",icon:e.jsx(C,{className:"text-gray-400 font-12",style:{fontSize:"0.95rem"}})},{title:"限电占比",value:(t==null?void 0:t.limitImpactRate.toFixed(2))+" %",description:"正常范围",icon:e.jsx(v,{className:"text-gray-500 font-12"})},{title:"其他占比",value:m+" %",description:"正常范围",icon:e.jsx(A,{className:"text-gray-500 font-12"})}],c=a=>a>=90?{borderColor:"#52c41a",textColor:"text-green-600",backGround:"rgba(204, 250, 232, 0.4)",gradient:"from-green-50 to-green-100"}:a>=80?{borderColor:"#1890ff",textColor:"text-blue-600",backGround:"rgba(204, 204, 250, 0.4)",gradient:"from-blue-50 to-blue-100"}:a>=60?{borderColor:"#faad14",textColor:"text-orange-600",backGround:"rgba(250, 235, 204,0.4)",gradient:"from-orange-50 to-orange-100"}:{borderColor:"#f5222d",textColor:"text-red-600",backGround:"rgba(250, 229, 204, 0.4)",gradient:"from-red-50 to-red-100"};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-100 rounded-xl p-4 mb-4",style:{background:"#fff",borderRadius:"4px"},children:[e.jsxs("h3",{className:"text-xl font-bold mb-6 text-gray-800 pl-2",children:[e.jsx(R,{className:`mr-2 ${c((t==null?void 0:t.effectiveRate24h)||0).textColor}`}),"算力运行状态"]}),e.jsxs("div",{className:"bg-white rounded-lg grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg shadow-demo border-2 ${c((t==null?void 0:t.effectiveRate24h)||0).gradient}`,style:{borderColor:c((t==null?void 0:t.effectiveRate24h)||0).borderColor,background:c((t==null?void 0:t.effectiveRate24h)||0).backGround},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-lg font-semibold ${c((t==null?void 0:t.effectiveRate24h)||0).textColor}`,children:"算力有效率"}),e.jsx(R,{className:` text-xl ${c((t==null?void 0:t.effectiveRate24h)||0).textColor}`})]}),e.jsxs("div",{className:`text-4xl font-bold ${c((t==null?void 0:t.effectiveRate24h)||0).textColor}`,children:[t==null?void 0:t.effectiveRate24h.toFixed(2),"%"]})]}),l.map((a,r)=>e.jsxs("div",{className:"shadow-demo p-6 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:a.title}),a.icon]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:a.value})]},r))]})]}),e.jsxs("div",{className:"bg-gray-100 rounded-xl p-4 mb-4",style:{background:"#fff",borderRadius:"4px"},children:[e.jsxs("h3",{className:"text-xl font-bold mb-6 text-gray-800 pl-2",children:[e.jsx(I,{className:"mr-2 text-red-500"}),"算力影响因素"]}),e.jsxs("div",{className:"bg-white rounded-lg grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-gradient-to-br shadow-demo from-red-100 to-red-50 border-2 border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-lg font-semibold text-red-600",children:"算力影响"}),e.jsx(I,{className:"text-red-500 text-xl"})]}),e.jsxs("div",{className:"text-4xl font-bold text-red-500",children:[t==null?void 0:t.impactRatio.toFixed(2)," %"]})]}),h.map((a,r)=>e.jsxs("div",{className:"p-6 shadow-sm shadow-demo rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600 font-semibold",children:a.title}),a.icon]}),e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:a.value})]},r))]})]})]})},Y=()=>{const[d,t]=f.useState(!0),o=f.useRef([]),[m,g]=f.useState([{id:"hashrate-chart",title:"算力有效率变化曲线",period:"day"},{id:"failure-chart",title:"故障率变化曲线",period:"day"},{id:"temperature-chart",title:"高温影响曲线",period:"day"},{id:"power-chart",title:"限电影响曲线",period:"day"}]),u=a=>{const r=a==="day"?30:12;return a==="day"?Array.from({length:r},(i,s)=>{const n=new Date;return n.setDate(n.getDate()-s),n.toLocaleDateString("zh-CN")}).reverse():Array.from({length:r},(i,s)=>{const n=new Date;return n.setMonth(n.getMonth()-s),`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}).reverse()},p=(a,r)=>{const i={animation:!1,tooltip:{trigger:"axis"},xAxis:{type:"category",data:r},yAxis:{type:"value"},series:[{type:"line",smooth:!0,data:[],lineStyle:{color:"#2563eb"},areaStyle:{color:new z(0,0,0,1,[{offset:0,color:"rgba(37, 99, 235, 0.2)"},{offset:1,color:"rgba(37, 99, 235, 0)"}])}}]},s=i.series[0];switch(a){case"hashrate-chart":i.yAxis={min:95,max:100},s.data=r.map(()=>Number((95+Math.random()*5).toFixed(1)));break;case"failure-chart":i.yAxis={min:0,max:3},s.data=r.map(()=>Number((Math.random()*2).toFixed(1))),s.lineStyle.color="#dc2626";break;case"temperature-chart":i.yAxis={min:0,max:1},s.data=r.map(()=>Number((Math.random()*.5).toFixed(2))),s.lineStyle.color="#ea580c";break;case"power-chart":i.yAxis={min:0,max:2},s.data=r.map(()=>Number((Math.random()*1.5).toFixed(1))),s.lineStyle.color="#7c3aed";break}return i},x=()=>{const a={};m.forEach((r,i)=>{const s=o.current[i];if(s){const n=T(s),b=u(r.period);n.setOption(p(r.id,b)),a[r.id]=n}}),window.addEventListener("resize",()=>{Object.values(a).forEach(r=>r.resize())})};f.useEffect(()=>{x()},[]);const l=[{title:"日期",dataIndex:"date",key:"date"},{title:"收益 (¥)",dataIndex:"income",key:"income",align:"right"},{title:"算力有效率",dataIndex:"hashrateEfficiency",key:"hashrateEfficiency",align:"right"},{title:"故障率",dataIndex:"failureRate",key:"failureRate",align:"right"},{title:"限电影响",dataIndex:"powerLimit",key:"powerLimit",align:"right"},{title:"高温影响",dataIndex:"temperatureImpact",key:"temperatureImpact",align:"right"}],h=[{title:"场地",dataIndex:"site",key:"site"},{title:"影响时长",dataIndex:"duration",key:"duration"},{title:"时间范围",dataIndex:"timeRange",key:"timeRange"},{title:"事件类型",dataIndex:"eventType",key:"eventType"},{title:"影响台数",dataIndex:"affectedMachines",key:"affectedMachines",align:"right"},{title:"影响算力",dataIndex:"hashrateImpact",key:"hashrateImpact",align:"right"},{title:"时间原因",dataIndex:"reason",key:"reason"}],c=[{key:"1",date:"2024-01-20",income:"286,521",hashrateEfficiency:"98.6%",failureRate:"1.4%",powerLimit:"0.8%",temperatureImpact:"0.2%"}],y=[{key:"1",site:"杭州滨江矿场",duration:"2小时",timeRange:"2025-08-19 14:00-16:00",eventType:"电力故障",affectedMachines:"126台",hashrateImpact:"-1.8%",reason:"变电站检修时间"}];return e.jsxs("div",{className:" mx-auto  min-h-screen",children:[e.jsxs("header",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"杭州滨江矿场"}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded-md",children:"矿工号: MW-2025-086"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"text-primary"}),e.jsx("span",{className:"text-gray-600",children:"浙江省杭州市滨江区长河街道长江路258号"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"text-primary"}),e.jsx("span",{className:"text-gray-600",children:"2025-08-19 星期二"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"text-primary"}),e.jsx("span",{className:"text-gray-600",children:"当前温度: 26°C"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"text-primary"}),e.jsx("span",{className:"text-gray-600",children:"当前湿度: 65%"})]})]})]})]}),e.jsx(B,{}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-8",children:m.map((a,r)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.title}),e.jsxs(j.Group,{value:a.period,onChange:i=>{const s=[...m];s[r].period=i.target.value,g(s)},size:"small",children:[e.jsx(j.Button,{value:"day",children:"日"}),e.jsx(j.Button,{value:"month",children:"月"})]})]}),e.jsx("div",{ref:i=>o.current[r]=i,style:{height:300}})]},r))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{type:d?"primary":"default",onClick:()=>t(!0),children:"经营日报"}),e.jsx(N,{type:d?"default":"primary",onClick:()=>t(!1),children:"异常事件"})]}),e.jsx(N,{type:"primary",children:"查看更多"})]}),d?e.jsx(k,{columns:l,dataSource:c,pagination:!1,rowKey:"key"}):e.jsx(k,{columns:h,dataSource:y,pagination:!1,rowKey:"key"})]})]})};export{Y as default};
