var g=(l,t,r)=>new Promise((s,c)=>{var f=a=>{try{m(r.next(a))}catch(p){c(p)}},h=a=>{try{m(r.throw(a))}catch(p){c(p)}},m=a=>a.done?s(a.value):Promise.resolve(a.value).then(f,h);m((r=r.apply(l,t)).next())});import{a as z,b as Y,j as o,R}from"./index-BQyPqspz.js";import{r as y,u as I}from"./react-BIszHAjf.js";import{d as x,j as D,k as d,h as S,x as b,W as k,Z as A}from"./antd-CcxI5lPu.js";import{R as _,u as M,dV as P,dR as B,dM as L,dP as $}from"./index-QmVSDIUV.js";import{u as E}from"./useAuthRedirect-DNmXPPTY.js";import{a as v}from"./fetchHelper-Vw8p4Uhc.js";import{i as W}from"./install-Be5m4s8K.js";const N=(l,t,r)=>g(void 0,null,function*(){return yield v(`miningPool/getIncomeStatisticsHistory/${l}/${t}/${r}`)}),{RangePicker:O}=A;M([P,B,L,$,W]);function X(){E();const{poolType:l}=z(Y(["poolType"])),[t,r]=y.useState(null),[s,c]=y.useState((()=>{const e=x().subtract(10,"day").startOf("day"),n=x().startOf("day");return[e,n]})()),f=I(),h=e=>{f(R.poolProfitHistory(e))},m=e=>g(this,null,function*(){try{const n=s[0]?s[0].format("YYYY-MM-DD"):x().subtract(1,"day").format("YYYY-MM-DD"),u=s[1]?s[1].format("YYYY-MM-DD"):x().format("YYYY-MM-DD"),T=yield N(e,n,u);r(T.data)}catch(n){}});y.useEffect(()=>{m(l)},[l,s]);const a=[{title:"矿池名称",dataIndex:"pool_name",key:"pool_name",render:(e,n)=>o.jsx("a",{onClick:()=>h(n.pool_name),style:{color:"#252F4A",cursor:"pointer"},children:e})},{title:"收入 (BTC)",dataIndex:"income_btc",key:"income_btc",render:e=>e.toFixed(8)},{title:"收入 (USD)",dataIndex:"income_usd",key:"income_usd",render:e=>e.toFixed(2)},{title:"托管费用",dataIndex:"hosting_fee",key:"hosting_fee",render:e=>e.toFixed(2)},{title:"托管比例",dataIndex:"hosting_ratio",key:"hosting_ratio",render:e=>e.toFixed(2)+" %"}],p=e=>{if(e&&e[0]&&e[1]){const n=e[0],u=e[1];c([n,u])}else c([null,null])},w={grid:{top:"0%",right:"0%",bottom:"5%",left:"5%"},series:[{type:"gauge",startAngle:180,endAngle:0,center:["50%","75%"],radius:"100%",min:0,max:100,splitNumber:8,axisLine:{lineStyle:{width:6,color:[[.5,"#58D9F9"],[.9,"#FDDD60"],[1,"#FF6E76"]]}},pointer:{icon:"path://M12.8,0.7l12,40.1H0.7L12.8,0.7z",length:"25%",width:6,offsetCenter:[0,"-60%"],itemStyle:{color:"auto"}},axisTick:{length:10,lineStyle:{color:"auto",width:1}},splitLine:{length:12,lineStyle:{color:"auto",width:2}},axisLabel:{color:"#464646",fontSize:20,distance:-60,rotate:"tangential",formatter:function(){return""}},title:{offsetCenter:[0,"-10%"],fontSize:20},detail:{fontSize:30,offsetCenter:[0,"-35%"],valueAnimation:!0,formatter:function(e){return Math.round(e)+""},color:"inherit"},data:[{value:(t==null?void 0:t.total_hosting_ratio)||50}]}]},j=new Date;j.setHours(0,0,0,0);const i=t==null?void 0:t.data2.filter(e=>new Date(e.date).getTime()<j.getTime()).sort((e,n)=>new Date(e.date).getTime()-new Date(n.date).getTime()),F=e=>{if(e>=1e8)return(e/1e8).toFixed(2)+"亿";if(e>=1e6)return(e/1e6).toFixed(2)+"百万";if(e>=1e4)return(e/1e4).toFixed(2)+"万";if(e>=1e3)return(e/1e3).toFixed(2)+"千";if(e>=100)return(e/100).toFixed(2)+"百";{const n=e.toFixed(2);return Number(n)===parseInt(n)?parseInt(n):n}},C={tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#464646",fontSize:12}}},grid:{top:"25%",right:"15%",bottom:"12%",left:"10%"},legend:{data:["收入 (BTC)","收入 (USD)","托管费用"],top:"-3%",icon:"circle",textStyle:{fontSize:12,color:"#464646"},itemWidth:8,itemHeight:8,itemGap:10},xAxis:{type:"category",axisLine:{show:!1},axisLabel:{show:!0,color:"#99a1b7",fontSize:10,formatter:function(e){return e.substr(5)}},data:i==null?void 0:i.map(e=>e.date)},yAxis:[{type:"value",name:"收入 (BTC)",position:"left",axisLabel:{formatter:"{value}",fontSize:10,color:"#99a1b7"}},{type:"value",name:"金额 (USD)",position:"right",splitLine:{show:!1},axisLabel:{fontSize:10,color:"#99a1b7",formatter:function(e){return F(e)}}}],series:[{name:"收入 (BTC)",type:"line",symbol:"none",data:i==null?void 0:i.map(e=>e.income_btc),itemStyle:{color:"#58D9F9"},yAxisIndex:0,smooth:!0},{name:"收入 (USD)",type:"line",symbol:"none",data:i==null?void 0:i.map(e=>e.income_usd),itemStyle:{color:"#FDDD60"},yAxisIndex:1,smooth:!0},{name:"托管费用",type:"line",symbol:"none",data:i==null?void 0:i.map(e=>e.hosting_fee),itemStyle:{color:"#FF6E76",barWidth:2},yAxisIndex:1,smooth:!0}]};return o.jsxs("div",{children:[o.jsx(O,{value:s,onChange:p,style:{width:"280px",fontSize:"12px"}}),o.jsx("div",{style:{marginBottom:"20px",marginTop:"20px"},children:o.jsxs(D,{gutter:24,style:{display:"flex"},children:[o.jsx(d,{span:8,children:o.jsx(S,{title:"统计数据",children:o.jsxs(D,{gutter:24,style:{height:"200px"},children:[o.jsx(d,{span:24,style:{marginBottom:"20px"},children:o.jsx(b,{title:"总收益BTC",value:t==null?void 0:t.total_income_btc,valueStyle:{fontSize:"16px",fontWeight:"bold"}})}),o.jsx(d,{span:24,style:{marginBottom:"20px"},children:o.jsx(b,{title:"总收益($)",value:t==null?void 0:t.total_income_usd,valueStyle:{fontSize:"16px",fontWeight:"bold"}})}),o.jsx(d,{span:24,style:{marginBottom:"20px"},children:o.jsx(b,{title:"总托管费用($)",value:t==null?void 0:t.total_hosting_fee,valueStyle:{fontSize:"16px",fontWeight:"bold"}})})]})})}),o.jsx(d,{span:8,children:o.jsx(S,{title:"托管费占比",children:o.jsx(_,{option:w,style:{height:"200px",width:"100%"}})})}),o.jsx(d,{span:8,children:o.jsx(S,{title:"曲线图",children:o.jsx(_,{option:C,style:{height:"200px",width:"100%"}})})})]})}),o.jsx(k,{dataSource:t==null?void 0:t.data,columns:a,rowKey:"pool_name",style:{marginTop:"20px"},pagination:{position:["bottomCenter"],showSizeChanger:!0,pageSizeOptions:["10","20","30","50"],defaultPageSize:10}})]})}export{X as default};
