import{a as L,b as A,j as t}from"./index-DwDhpg0B.js";import{r,L as D}from"./react-BB_nszRd.js";import{F as N,a as B}from"./index-NjyaqLyy.js";import{G as P}from"./iconBase-qV-xELIz.js";import{E}from"./index-VmnlSwWN.js";import{u as $}from"./useAuthRedirect-0HZQIZtn.js";import{g as H}from"./excel-35wNsxPv.js";import{d as z}from"./hook-E3nL7ddX.js";import{z as h,U as d,N as m,k as M,l as g,y as p,I as O,Q as U,B as W,V as G}from"./antd-uOu3r8aR.js";import"./fetchHelper-CT8PCvwW.js";import"./xlsx-DaVhO591.js";import"./useQuery-DdRqVWwE.js";import"./useMutation-cbv7uPtW.js";import"./api-CjSqxUgu.js";function V(i){return P({tag:"svg",attr:{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 30 30",style:"enable-background:new 0 0 30 30;"},child:[{tag:"path",attr:{d:`M10.05,17.55c0,0.3,0.09,0.55,0.26,0.73c0.2,0.19,0.46,0.28,0.79,0.28c0.3,0,0.55-0.09,0.73-0.28l6.04-6.05v1.95
	c0,0.3,0.1,0.55,0.3,0.75c0.2,0.2,0.45,0.3,0.75,0.3c0.29,0,0.54-0.1,0.74-0.31s0.3-0.45,0.3-0.75V9.7c0-0.3-0.1-0.55-0.3-0.75
	s-0.45-0.3-0.74-0.3h-4.5c-0.29,0-0.54,0.1-0.73,0.3S13.4,9.39,13.4,9.7c0,0.29,0.1,0.54,0.29,0.73s0.44,0.29,0.73,0.29h1.95
	l-6.06,6.06C10.14,16.99,10.05,17.25,10.05,17.55z`},child:[]}]})(i)}const v="mining-hash";function oe(){$();const{poolType:i}=L(A(["poolType"])),[u,y]=r.useState(localStorage.getItem(`${v}_poolCategory`)||"主矿池"),{data:o,isLoading:f}=z(i,u),[j,w]=r.useState([]),[S,c]=r.useState([]),[x,b]=r.useState("");r.useEffect(()=>{if(o&&o.data){const a=o.data.map((e,s)=>({venue_id:e.venue_id,serialNumber:s+1,venue_name:e.venue_name,pool_name:e.pool_name,current_hash:e.current_hash,online:e.online,offline:e.offline,last_hash:e.last_hash,last_settlement_hash:e.last_settlement_hash,theoretical:e.theoretical,last_hash_rate_effective:e.last_hash_rate_effective,last_settlement_profit_btc:e.last_settlement_profit_btc,last_settlement_profit_fb:e.last_settlement_profit_fb,last_settlement_date:e.last_settlement_date,update_time:e.update_time,link:e.link}));c(a)}else c([])},[o]),r.useEffect(()=>{w([{dataIndex:"serialNumber",key:"serialNumber",width:25,render:(a,e)=>{const{link:s}=e;return s.includes("antpool")?t.jsx(N,{style:{color:"green",fontSize:16}}):s.includes("f2pool")?t.jsx(B,{style:{color:"orange",fontSize:16}}):t.jsx("span",{children:e.serialNumber})}},{title:"场地",dataIndex:"venue_name",key:"venue_name",width:200,render:(a,e)=>{const s=a==="Arct-HF01-J XP-AR-US"||a==="ARCT Technologies-HF02-AR-US";return t.jsx(h,{title:a,placement:"top",overlayInnerStyle:{color:"white"},style:{color:"white"},children:t.jsxs("div",{style:{width:"100%",overflow:"hidden",color:s?"red":"#333",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:s?"bold":"normal"},children:[t.jsx(D,{to:`/venue/detail/${e.venue_id}`,className:"text-blue-500 hover:underline",children:a}),s&&t.jsx(d,{color:"red",style:{marginLeft:2},children:"补充"})]})})}},{title:"子账户",dataIndex:"pool_name",key:"pool_name",responsive:["xs","sm","md"],render:a=>t.jsx(h,{title:a,placement:"top",overlayInnerStyle:{color:"white"},style:{color:"white"},children:t.jsx("div",{style:{width:"100%",overflow:"hidden",color:"#333",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:a})})},{title:"实时算力",dataIndex:"current_hash",key:"current_hash",render:a=>{const e=a.split(" ");return t.jsxs("span",{children:[e[0]," ",t.jsx("span",{className:"text-sm text-gray-500",children:e[1]})]})}},{title:"理论算力",dataIndex:"theoretical",key:"theoretical",render:a=>{const e=a.split(" ");return e[0]=="0.00"?"--":t.jsxs("span",{children:[e[0]," ",t.jsx("span",{className:"text-sm text-gray-500",children:e[1]})]})},sorter:(a,e)=>{const s=parseFloat(a.theoretical.split(" ")[0]),n=parseFloat(e.theoretical.split(" ")[0]);return s-n}},{title:"在线/离线",key:"status",width:"12%",render:(a,e)=>t.jsxs("span",{children:[t.jsx(d,{color:"success","v-if":e.online!=0,children:e.online}),t.jsx(d,{color:"error","v-if":e.offline!="0",children:e.offline})]})},{title:()=>t.jsx(h,{title:"昨日算力达成率",children:t.jsx("span",{style:{display:"inline-block",maxWidth:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:"达成率"})}),dataIndex:"last_hash_rate_effective",key:"last_hash_rate_effective",width:"5%",render:(a,e)=>{console.log(e.current_hash,e.theoretical);const s=e.current_hash.split(" ")[0],n=e.theoretical.split(" ")[0];let l=(s/n*100).toFixed(2)+"%";console.log(l);const F=parseFloat(l.replace("%",""));return t.jsx("span",{style:{color:F<90?"red":"green"},children:l})},sorter:(a,e)=>{const s=parseFloat(a.last_hash_rate_effective.replace("%","")),n=parseFloat(e.last_hash_rate_effective.replace("%",""));return s-n}},{title:"刷新时间",dataIndex:"update_time",key:"update_time",width:80,align:"right",render:a=>{const e=new Date(a),s=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),l=e.getSeconds().toString().padStart(2,"0");return`${s}:${n}:${l}`}},{title:"链接",dataIndex:"link",key:"link",width:50,render:a=>t.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",style:{color:"#252F4A"},title:a,children:t.jsx(V,{style:{marginLeft:8,fontSize:"32px"}})})}])},[]);const k=a=>{b(a.target.value)};if(f)return t.jsx(m,{tip:"加载中..."});const C=()=>new Promise(()=>{}),I=()=>new Promise(()=>{}),R=()=>{H(_)},T=a=>{y(a.target.value),localStorage.setItem(`${v}_poolCategory`,a.target.value)},_=S.filter(a=>Object.values(a).some(e=>String(e).toLowerCase().includes(x.toLowerCase()))).sort((a,e)=>{const s=a.venue_name.toLowerCase(),n=e.venue_name.toLowerCase();return s<n?-1:s>n?1:0});return t.jsxs("div",{style:{padding:"20px 0px"},className:"longdataTable",children:[t.jsxs(M,{gutter:[16,16],justify:"space-between",align:"middle",children:[t.jsx(g,{xs:24,sm:24,md:12,children:t.jsxs(p.Group,{className:"filterRadio",onChange:T,value:u,children:[t.jsx(p.Button,{value:"主矿池",children:"主矿池"}),t.jsx(p.Button,{value:"备用矿池",children:"备用矿池"})]})}),t.jsx(g,{xs:24,sm:24,md:12,children:t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"flex-end"},children:[t.jsx(O,{prefix:t.jsx(U,{}),placeholder:"搜索",value:x,onChange:k,style:{width:"200px"}}),t.jsx(W,{icon:t.jsx(G,{}),onClick:R,children:"导出"})]})})]}),f?t.jsx(m,{style:{width:"100%",textAlign:"center",marginTop:"50%"}}):t.jsx(E,{tableData:_,setTableData:c,columns:j,handleDelete:C,handleSave:I})]})}export{oe as default};
